{"version":3,"file":"index.js","sources":["../../../../../src/components/modal/src/index.tsx"],"sourcesContent":["import { type ExtractPropTypes, type PropType, Teleport, Transition, computed, defineComponent } from 'vue'\r\nimport { type ToggleHandler, useDraggable, useModal } from '../../../composables'\r\nimport { animation } from '../../../utils'\r\nimport Button from '../../button/src/index.vue'\r\n\r\nexport interface ModalInstance extends ToggleHandler, HTMLElement {}\r\nexport type ModalProps = ExtractPropTypes<typeof modalProps>\r\ntype ShakeOffProp = 'x-button' | 'confirm-button' | 'cancel-button' | 'mask' | 'header' | 'footer'\r\n\r\nconst modalProps = {\r\n  shakeOff: {\r\n    type: Array as PropType<ShakeOffProp[]>,\r\n    default: () => [],\r\n  },\r\n  title: {\r\n    type: String,\r\n    default: '',\r\n  },\r\n  cancelText: {\r\n    type: String,\r\n    default: 'Cancel',\r\n  },\r\n  confirmText: {\r\n    type: String,\r\n    default: 'Confirm',\r\n  },\r\n  draggable: Boolean,\r\n}\r\n\r\nexport default defineComponent({\r\n  name: 'Modal',\r\n  props: modalProps,\r\n  emits: [\r\n    'open',\r\n    'close',\r\n    'cancel',\r\n    'confirm',\r\n  ],\r\n  setup(props, { slots, emit }) {\r\n    const { modal } = useModal(emit)\r\n\r\n    useDraggable(modal, {\r\n      translateX: computed(\r\n        () => modal.state.value\r\n          ? modal.value!.clientWidth / 2\r\n          : 0,\r\n      ),\r\n    })\r\n    const isShake = (prop: ShakeOffProp) => props.shakeOff.includes(prop)\r\n\r\n    const onCancel = () => modal.close() && emit('cancel')\r\n\r\n    const onConfirm = () => emit('confirm')\r\n\r\n    const onClose = () => modal.close()\r\n\r\n    const renderHeader = () => {\r\n      if (!isShake('header') && props.title) {\r\n        return (\r\n          <header>\r\n            <h3>{ props.title }</h3>\r\n          </header>\r\n        )\r\n      }\r\n    }\r\n\r\n    const renderFooter = () => {\r\n      if (isShake('footer'))\r\n        return\r\n\r\n      const renderButtons = []\r\n      if (!isShake('cancel-button')) {\r\n        renderButtons.push(\r\n          <Button\r\n            type=\"outline\"\r\n            onClick={onCancel}\r\n            v-slots={{\r\n              default: props.cancelText,\r\n            }}\r\n          />,\r\n        )\r\n      }\r\n      if (!isShake('confirm-button')) {\r\n        renderButtons.push(\r\n          <Button\r\n            type=\"solid\"\r\n            onClick={onConfirm}\r\n            v-slots={{\r\n              default: props.confirmText,\r\n            }}\r\n          />,\r\n        )\r\n      }\r\n\r\n      return (\r\n        <footer>\r\n          <div class=\"pl-modal-button\">\r\n            {renderButtons}\r\n          </div>\r\n        </footer>\r\n      )\r\n    }\r\n\r\n    const renderModal = () => {\r\n      const renderMask = () => {\r\n        if (!isShake('mask'))\r\n          return <div class={'pl-mask'} />\r\n      }\r\n\r\n      const renderXButton = () => {\r\n        if (!isShake('x-button')) {\r\n          return (\r\n            <Button\r\n              class='pl-modal-x'\r\n              type='link'\r\n              state='info'\r\n              icon-left='x-lg'\r\n              onClick={onClose}\r\n            />\r\n          )\r\n        }\r\n      }\r\n\r\n      return (\r\n        <>\r\n          {renderMask()}\r\n          <div\r\n            ref={modal}\r\n            class=\"pl-modal\"\r\n            draggable={props.draggable}\r\n          >\r\n            {renderXButton()}\r\n            {renderHeader()}\r\n            <section>\r\n              {slots.default?.()}\r\n            </section>\r\n            {renderFooter()}\r\n          </div>\r\n        </>\r\n      )\r\n    }\r\n    const renderHeadless = () => (\r\n      <div ref={modal}>\r\n        {slots.headless?.()}\r\n      </div>\r\n    )\r\n\r\n    return () => (\r\n      <Teleport to={'body'}>\r\n        <Transition\r\n          enter-active-class={animation('fadeIn')}\r\n          leave-active-class={animation('fadeOut')}\r\n          appear\r\n        >\r\n          <div v-show={modal.state.value}>\r\n            {slots.headless ? renderHeadless() : renderModal()}\r\n          </div>\r\n        </Transition>\r\n      </Teleport>\r\n    )\r\n  },\r\n})\r\n"],"names":["defineComponent","useModal","useDraggable","computed","_createVNode","Button","_Fragment","Teleport","Transition","animation","_withDirectives","_vShow"],"mappings":";;;;;;;AAKA,MAAM,aAAa;AAAA,EACjB,UAAU;AAAA,IACR,MAAM;AAAA,IACN,SAAS,MAAM,CAAE;AAAA,EAClB;AAAA,EACD,OAAO;AAAA,IACL,MAAM;AAAA,IACN,SAAS;AAAA,EACV;AAAA,EACD,YAAY;AAAA,IACV,MAAM;AAAA,IACN,SAAS;AAAA,EACV;AAAA,EACD,aAAa;AAAA,IACX,MAAM;AAAA,IACN,SAAS;AAAA,EACV;AAAA,EACD,WAAW;AACb;AACA,MAAe,QAAgBA,oCAAgB;AAAA,EAC7C,MAAM;AAAA,EACN,OAAO;AAAA,EACP,OAAO,CAAC,QAAQ,SAAS,UAAU,SAAS;AAAA,EAC5C,MAAM,OAAO;AAAA,IACX;AAAA,IACA;AAAA,EACJ,GAAK;AACD,UAAM;AAAA,MACJ;AAAA,IACN,IAAQC,SAAAA,SAAS,IAAI;AACjBC,iBAAAA,aAAa,OAAO;AAAA,MAClB,YAAYC,IAAQ,SAAC,MAAM,MAAM,MAAM,QAAQ,MAAM,MAAM,cAAc,IAAI,CAAC;AAAA,IACpF,CAAK;AACD,UAAM,UAAU,UAAQ,MAAM,SAAS,SAAS,IAAI;AACpD,UAAM,WAAW,MAAM,MAAM,MAAK,KAAM,KAAK,QAAQ;AACrD,UAAM,YAAY,MAAM,KAAK,SAAS;AACtC,UAAM,UAAU,MAAM,MAAM;AAC5B,UAAM,eAAe,MAAM;AACzB,UAAI,CAAC,QAAQ,QAAQ,KAAK,MAAM,OAAO;AACrC,eAAOC,gBAAa,UAAU,MAAM,CAACA,IAAAA,YAAa,MAAM,MAAM,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;AAAA,MAC9E;AAAA,IACP;AACI,UAAM,eAAe,MAAM;AACzB,UAAI,QAAQ,QAAQ;AAAG;AACvB,YAAM,gBAAgB,CAAA;AACtB,UAAI,CAAC,QAAQ,eAAe,GAAG;AAC7B,sBAAc,KAAKA,IAAY,YAACC,mDAAQ;AAAA,UACtC,QAAQ;AAAA,UACR,WAAW;AAAA,QACrB,GAAW;AAAA,UACD,SAAS,MAAM;AAAA,QAChB,CAAA,CAAC;AAAA,MACH;AACD,UAAI,CAAC,QAAQ,gBAAgB,GAAG;AAC9B,sBAAc,KAAKD,IAAY,YAACC,mDAAQ;AAAA,UACtC,QAAQ;AAAA,UACR,WAAW;AAAA,QACrB,GAAW;AAAA,UACD,SAAS,MAAM;AAAA,QAChB,CAAA,CAAC;AAAA,MACH;AACD,aAAOD,IAAY,YAAC,UAAU,MAAM,CAACA,IAAAA,YAAa,OAAO;AAAA,QACvD,SAAS;AAAA,MACjB,GAAS,CAAC,aAAa,CAAC,CAAC,CAAC;AAAA,IAC1B;AACI,UAAM,cAAc,MAAM;;AACxB,YAAM,aAAa,MAAM;AACvB,YAAI,CAAC,QAAQ,MAAM;AAAG,iBAAOA,IAAAA,YAAa,OAAO;AAAA,YAC/C,SAAS;AAAA,UACV,GAAE,IAAI;AAAA,MACf;AACM,YAAM,gBAAgB,MAAM;AAC1B,YAAI,CAAC,QAAQ,UAAU,GAAG;AACxB,iBAAOA,IAAAA,YAAaC,0CAAAA,SAAQ;AAAA,YAC1B,SAAS;AAAA,YACT,QAAQ;AAAA,YACR,SAAS;AAAA,YACT,aAAa;AAAA,YACb,WAAW;AAAA,UACZ,GAAE,IAAI;AAAA,QACR;AAAA,MACT;AACM,aAAOD,IAAAA,YAAaE,IAAAA,UAAW,MAAM,CAAC,WAAY,GAAEF,IAAY,YAAC,OAAO;AAAA,QACtE,OAAO;AAAA,QACP,SAAS;AAAA,QACT,aAAa,MAAM;AAAA,MAC3B,GAAS,CAAC,cAAa,GAAI,aAAc,GAAEA,IAAY,YAAC,WAAW,MAAM,EAAC,WAAM,YAAN,8BAAiB,CAAC,GAAG,aAAY,CAAE,CAAC,CAAC,CAAC;AAAA,IAChH;AACI,UAAM,iBAAiB;;AAAMA,iBAAY,YAAC,OAAO;AAAA,QAC/C,OAAO;AAAA,MACR,GAAE,EAAC,WAAM,aAAN,8BAAkB,CAAC;AAAA;AACvB,WAAO,MAAMA,IAAY,YAACG,cAAU;AAAA,MAClC,MAAM;AAAA,IACZ,GAAO;AAAA,MACD,SAAS,MAAM,CAACH,IAAY,YAACI,gBAAY;AAAA,QACvC,sBAAsBC,MAAS,UAAC,QAAQ;AAAA,QACxC,sBAAsBA,MAAS,UAAC,SAAS;AAAA,QACzC,UAAU;AAAA,MAClB,GAAS;AAAA,QACD,SAAS,MAAM,CAACC,IAAAA,eAAgBN,IAAY,YAAC,OAAO,MAAM,CAAC,MAAM,WAAW,eAAgB,IAAG,YAAa,CAAA,CAAC,GAAG,CAAC,CAACO,IAAAA,OAAQ,MAAM,MAAM,KAAK,CAAC,CAAC,CAAC;AAAA,MACtJ,CAAO,CAAC;AAAA,IACR,CAAK;AAAA,EACF;AACH,CAAC;;"}